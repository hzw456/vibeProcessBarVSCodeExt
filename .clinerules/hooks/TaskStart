#!/bin/bash
# Cline Hook: TaskStart - 任务开始时通知Vibe Process Bar

# 读取stdin的JSON输入
INPUT=$(cat)

# 提取任务信息
TASK_ID=$(echo "$INPUT" | jq -r '.taskId // "unknown"')
TIMESTAMP=$(echo "$INPUT" | jq -r '.timestamp // ""')

# 生成唯一的task_id
VIBE_TASK_ID="cline_${TASK_ID}"

# 发送开始任务请求到Vibe Process Bar
curl -s -X POST "http://localhost:31415/api/task/start" \
  -H "Content-Type: application/json" \
  -d "{
    \"task_id\": \"${VIBE_TASK_ID}\",
    \"name\": \"Cline AI Task\",
    \"ide\": \"vscode-cline\",
    \"window_title\": \"Cline - VS Code\"
  }" > /dev/null 2>&1

# 返回成功响应（不阻止任务）
echo '{"cancel": false}'
